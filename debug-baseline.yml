tenant:
  allowed_logout_urls:
    - https://enterprise-secure-logout.com
    - https://{base_url}/logout
  flags:
    enable_sso: true
    disable_clickjack_protection_headers: false
  breach_detection_enabled: true
  refresh_token:
    rotation: true
    revoke_on_use: true
    expiration_type: expiring
    lifetime_in_seconds: 7776000 # 90 days
    idle_lifetime_in_seconds: 2592000 # 30 days
    leeway: 604800 # 7 days
  session_lifetime: 1800 # 30 minutes in seconds
  idle_session_lifetime: 86400 # 24 hours in seconds
passwordPolicy:
  length:
    min: 16 # This overrides hardening.yml
  includeNumbers: true
  includeSymbols: true
  includeUppercase: true
  includeLowercase: true
  history: 10
guardianMfaPolicy:
  factors:
    - name: otp
      enabled: true
    - name: webauthn-roaming
      enabled: true
    - name: sms
      enabled: false
rules:
  - name: Security Audit Login Logger
    script: |
      function (user, context, callback) {
        console.log('LOGIN_AUDIT:', {
          userId: user.user_id,
          email: user.email,
          ip: context.request.ip,
          timestamp: new Date().toISOString(),
          userAgent: context.request.userAgent
        });
        callback(null, user, context);
      }
    order: 0
    enabled: true
# Default token settings for applications
clients:
  - name: default-app
    token_endpoint_auth_method: client_secret_post
    jwt_configuration:
      lifetime_in_seconds: 3600 # 1 hour access tokens
    refresh_token:
      expiration_type: expiring
      lifetime_in_seconds: 1209600 # 14 days
